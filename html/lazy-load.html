<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="utf-8">
        <title>Ленивая загрузка</title>
        <meta name="viewport" content="initial-scale=1, maximum-scale=1">
        <meta name="description" content="Ленивая загрузка изображений для сайта или lazy load, с примером написания на javascript с описанием.">
        <link rel="canonical" href="https://nasobe.ru/lazy-load.html">
        <meta name="robots" content="all">
        <meta name="autor" content="Amir Shikarno">
        <!-- <script data-ad-client="ca-pub-6824659625881284" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->
        <style>
            *{
                margin:0;
            }
            body{
                background-color: rgb(193, 214, 171);
                background: linear-gradient(to bottom, rgba(0, 128, 0, 0.178), rgba(255, 0, 0, 0.363));
                font-size: 20px;
            }
            main{
                display:flex;
                max-width: 100%;
                flex-direction:column;
                justify-content: center;
                align-items: center;
                word-wrap: break-word;
            }
            .first{
                display:flex;
                max-width: 100%;
                flex-direction:column;
                justify-content: center;
                align-items: center;
                word-wrap: break-word;
            }
            section{
                display:flex;
                max-width: 100%;
                width: 700px;
                flex-direction: column;

            }
            article{
                display:flex;
                width:700px;
                max-width: 100%;
                background-color: rgb(207, 255, 160);
                flex-direction: column;
            }
            .margin{
                margin: 1%;
            }
            .bgOrange{
                background-color: coral;
            }
            .bgOrangeTwo{
                background-color: rgb(255, 136, 0);
            }
            h1{
                text-align: center;
            }
            h2{
                text-align: center;
            }
            img{
                max-width: 100%;
            }
            .dis{
                display:flex;
                justify-content: center;
                align-items: center;
                background-color: rgba(255, 202, 137, 0.568);

            }
            .left{
                background-color: rgba(255, 202, 137, 0.829);
                margin: 1%;
                padding: 1%;
                border-radius: 50%;
            }
            .right{
                background-color: rgba(255, 202, 137, 0.829);
                margin: 1%;
                padding: 1%;
                border-radius: 50%;
            }
            footer{
                text-align: center;
                width:700px;
                max-width: 100%;
            }
            .marginDis{
                margin: 10%;
            }
        </style>
        <!-- Разметка JSON-LD, созданная Мастером разметки структурированных данных Google. -->
<script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Article",
      "name" : "Lazy load",
      "headline": "Подгрузка изображений с помощью IntersectionObserver",
      "author" : {
        "@type" : "Person",
        "name" : "Amir Navrutdinov",
        "alternateName": ["Amir Shikarno", "Амир Наврутдинов"]
      },
      "datePublished" : "2020-11-1",
      "image" : "https://nasobe.ru/images/working-for-free/aitoverstauzen.png",
      "articleSection" : "лейзи лод представлен практически как есть",
      "articleBody" : "Это загрузка изображений, когда они по очереди “подключаются” без создания паники и давки. Благодаря такой цивилизованности, загрузка происходит очень быстро.",
      "url" : "https://nasobe.ru/lazy-load.html",
      "publisher" : {
        "@type" : "Organization",
        "name" : "Веб мастерская имени Барона Сайтоверстаузена",
        "logo": {
            "@type": "ImageObject",
            "url": "https://nasobe.ru/images/lol/spa.webp"
      }
    }
}
    </script>
    </head>
    <body>

        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const imageObserver = new IntersectionObserver((entries, imgObserver) => {
                    entries.forEach((entry) => {
                        if (entry.isIntersecting) {
                            const lazyImage = entry.target;

                            console.log("lazy loading ", lazyImage);

                            lazyImage.src = lazyImage.dataset.src;
                        }
                    })
                });
                const arr = document.querySelectorAll('img.lzy_img');
                arr.forEach((v) => {
                    imageObserver.observe(v);
                })
            })

        let imgObserver = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
        }
        </script>
        <main>
            <article>
                <h1 class="bgOrange">Lazy load</h1>
                <p class="margin">*Или ленивая загрузка.</p>

                <p class="margin">Это загрузка изображений, когда они по очереди “подключаются” без создания паники и давки. Благодаря такой цивилизованности, загрузка происходит очень быстро. Скрипт с “ленивой загрузкой” Lazy load на самом деле, был стырен отсюда: <a href="https://habr.com/ru/company/ruvds/blog/453586/" target="_blank">https://habr.com/ru/company/ruvds/blog/453586/</a> и применен для данной галереи. IntersectionObserver  Поэтому сила лени “великая” заставила найти работающее решение на хабре.</p>
                <p class="margin">Если посмотреть скорость загрузки на пейд спид от гугла <a href="https://developers.google.com/speed/pagespeed/insights/?hl=ru&url=https%3A%2F%2Fnasobe.ru%2Flazy-load.html">https://developers.google.com/speed/pagespeed/insights/?hl=ru&url=https%3A%2F%2Fnasobe.ru%2Flazy-load.html</a> Можно убедиться что лейзи лод работает, как и требуется. Часть текста тут закрывает ленивца, чтобы ленивая загрузка действовала в полной красе и скорость всегда находилась в грин зоне.</p>
                <picture>
                    <source type="image/webp" srcset="images/lazy-load/len.webp">
                    <img class='lzy_img' src="images/lazy-load/image.png" data-src="images/lazy-load/len.jpeg" alt="ленивец">
                </picture>
                <p class="margin">Тут лейзи лод представлен практически как есть с хабра и посмотреть на работающий скрипт можно из панели разработчика “F12”. Скрипт с хабра скопипастен прям перед открывающим тегом боди.
                </p>


                <picture>
                    <source type="image/webp" srcset="images/lazy-load/imgM.webp">
                    <img class='lzy_img' loading="lazy" src="images/lazy-load/image.png" data-src="images/lazy-load/imgM.jpg" alt="picture">
                </picture>
                <h2 id="KostylReja" class="bgOrangeTwo">и исчО Костыльрея</h2>
                <p class="margin">Когда было очень надо найти суперское решения загружать фотографии не перезагружая страницу, но приутих наплыв страстей и уже неизвестно, надо ли оно вообще было или нет!</p>
                <script>

                    let i=0;
                    let slideDljaIMG = ['images/working-for-free/5.html','images/working-for-free/6.html','images/working-for-free/images.html', 'images/lol/gorilla-three.html', 'images/working-for-free/1.html','images/working-for-free/2.html','images/working-for-free/3.html','images/working-for-free/4.html'];
                    function ImagesPodmena(){

                        let podimg = new XMLHttpRequest();
                        podimg.open('GET',`${slideDljaIMG[i]}`);
                        podimg.send();
                        podimg.onload = function(){
                            if(podimg.status !=200){
                                alert(`Ошибка ${pogimg.status}: ${podimg.statusText}`);
                            }else { // если всё прошло гладко, выводим результат
                            // alert(`Готово, получили ${podimg.response.length} байт`); // response -- это ответ сервера
                            responseType ="Text";
                            document.querySelector('#images').innerHTML = this.response;
                            }
                        }
                    }
                    ImagesPodmena();

                </script>
                <div id='images'></div>
                <div class="dis">

                    <div class="left"><=</div> &nbsp&nbsp&nbsp&nbsp&nbsp
                    <div class='right'> => </div>

                </div>
                <script>

                    const leftButton = document.querySelector('.left');
                    leftButton.onclick = function(){

                        i-=1;
                        if(i<0){
                            i=([slideDljaIMG].length)-1;
                            setTimeout(ImagesPodmena(),10);
                            console.log([slideDljaIMG].length+'ny vot');
                        }

                        slideDljaIMG[i];
                        setTimeout(ImagesPodmena(),10);
                        console.log(slideDljaIMG.length+'iz i <0');
                        // console.log(slideDljaIMG[i]);

                    }
                    const rigthButton = document.querySelector(".right");
                    rigthButton.onclick = function(){

                        i+=1;
                        if(i>slideDljaIMG.length){
                            i=0;
                            setTimeout(ImagesPodmena(),10);
                            console.log(i+'--------------');
                        }
                        slideDljaIMG[i];
                        setTimeout(ImagesPodmena(),10);
                        console.log('--------------------');
                        console.log(slideDljaIMG[i]);
                        console.log(slideDljaIMG.length);
                        console.log("onclick-right-button");

                    }
                </script>
                <p class="margin">
                    Но наработка тут и вот, оно! кастыльрея - это как обычная галерея только на костылях для ускоренной загрузки.
                    Вместо изображений там подгружаются html страницы с тегом пикчер и все, можно было бы сделать подгрузку картинок напрямую, но пришлось бы делать выборку форматов изображений для разных браузеров, потому как формат webP еще до сих пор не используется в сафари.
                    Новшество кастыльреи в том что как показывает практика! Если бегуну отрубить ноги и приделать вместо них костыли, он будет бежать даже быстрее чем бежал бы на своих родных ногах https://www.youtube.com/watch?v=UPk3bDjGFek
                    Вот оно что оказывается. С гениальной логической последовательностью, достижимой лишь на грани просветления.

                </p>
                <p class="margin">P.S. Смотря какие конечно же костыли, тем более смотря где они используются. Потому как показывает практика можно изобрести велосипед и модифицировать его в костыльпед, который по скорости будет даже быстрее новенькой феррари. </p>
                <picture>
                    <source type="image/webp" srcset="images/lazy-load/foto96.webp">
                    <img class='lzy_img' src="images/lazy-load/image.png" data-src="images/lazy-load/foto96.jpeg" alt="lazy load">
                </picture>
            </article>

        <footer>
            <script src="https://yastatic.net/share2/share.js"></script>
            <div class="ya-share2 knop" data-curtain data-size="l" data-shape="round" data-services="vkontakte,facebook,odnoklassniki,telegram,twitter,viber,whatsapp,moimir,pinterest,skype,tumblr,linkedin,lj,blogger,reddit"></div>

        </footer>
        </main>
     <!-- ХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХ
                    Начало меню!
    ХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХХ-->
    <div id="menu"></div>

    <button class="burg">
    <svg
    xmlns="http://www.w3.org/2000/svg"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    width="40px" height="31px">
    <image  x="0px" y="0px" width="40px" height="31px"  xlink:href="data:img/png;base64,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" />
    </svg>

    </button>
   <!-- Счетчики -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-171292045-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-171292045-1');
</script>


<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(57628999, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57628999" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->



<script>

    //--------------------------------------------------------------
    //--------ОТПРАВИТЬ ЗАПРОС ЧТОБЫ ПОЛУЧИТЬ МЕНЮ------------------
    //--------------------------------------------------------------
function run(){
    var xhr = new XMLHttpRequest();
    xhr.open("GET", 'menu/menu.html', true);
    xhr.onreadystatechange = function() {//Вызывает функцию при смене состояния.
    if(xhr.readyState == XMLHttpRequest.DONE && xhr.status == 200) {
    document.getElementById("menu").innerHTML = this.responseText;
        }
    }
    xhr.send();
}
/*--------------------------------------------------------------------------
----------------ТУТ_ПРОИСХОДИТ_ОБНОВЛЕНИЕ_МЕНЮШКИ!--------------------------
--------------------------------------------------------------------------*/
                    //setInterval(run, 700);
                   setTimeout(run, 1000);
</script>

<link rel="stylesheet" href="menu/style-menu.css">
<script src="menu/script-menu.js"></script>





</body>
<div class="first">
    <section>
        <div id="sigCommentsBlock"></div>
        <a href="http://sigcomments.com" style="font-size: 0.6em;">Система комментирования SigComments</a>
        <script type="text/javascript">
            setTimeout(()=>(function(){
                var host_id = '5451';
                var script = document.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.src = '//sigcomments.com/chat/?host_id='+host_id;
                var ss = document.getElementsByTagName('script')[0];
                ss.parentNode.insertBefore(script, ss);
            })(),2500);
        </script>
    </section>
</div>
          <!-- Разметка JSON-LD, созданная Мастером разметки структурированных данных Google. -->
<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "LocalBusiness",
  "name" : "Верстка адаптивного сайта визитки",
  "url" : "https://nasobe.ru/",
  "image" : "https://nasobe.ru/images/logo.png",
  "review" : {
    "@type" : "Review",
    "author" : {
      "@type" : "Person",
      "name" : "Amir Navrutdinov"
    }
  }
}
</script>
</html>
